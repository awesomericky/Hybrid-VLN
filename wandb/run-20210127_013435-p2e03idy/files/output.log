Writing vocab of size 991 to tasks/R2R/data/train_vocab.txt
Writing vocab of size 1082 to tasks/R2R/data/trainval_vocab.txt
Loading image features from img_features/ResNet-152-imagenet.tsv
Loading navigation graphs for 61 scans
R2RBatch loaded with 14039 instructions, using splits: train
Loading image features from img_features/ResNet-152-imagenet.tsv
Loading navigation graphs for 56 scans
R2RBatch loaded with 1021 instructions, using splits: val_seen
Loading image features from img_features/ResNet-152-imagenet.tsv
Loading navigation graphs for 11 scans
R2RBatch loaded with 2349 instructions, using splits: val_unseen
/home/intern/miniconda3/envs/r2r_v2/lib/python3.6/site-packages/torch/nn/modules/rnn.py:46: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.5 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
Training with sample feedback
1m 0s (- 199m 54s) (100 0%) train loss: 1.1608, val_seen loss: 0.9586, success_rate: 0.017, val_unseen loss: 0.9511, success_rate: 0.015
1m 59s (- 197m 41s) (200 1%) train loss: 0.9440, val_seen loss: 0.9455, success_rate: 0.013, val_unseen loss: 0.9476, success_rate: 0.011
2m 56s (- 193m 37s) (300 1%) train loss: 0.9379, val_seen loss: 0.9449, success_rate: 0.011, val_unseen loss: 0.9271, success_rate: 0.014
3m 55s (- 192m 28s) (400 2%) train loss: 0.9294, val_seen loss: 0.9216, success_rate: 0.075, val_unseen loss: 0.9192, success_rate: 0.058
4m 52s (- 190m 18s) (500 2%) train loss: 0.9225, val_seen loss: 0.9059, success_rate: 0.086, val_unseen loss: 0.9288, success_rate: 0.065
Traceback (most recent call last):
  File "tasks/R2R/train.py", line 180, in <module>
    train_val()
  File "tasks/R2R/train.py", line 163, in train_val
    train(train_env, encoder, decoder, n_iters, val_envs=val_envs)
  File "tasks/R2R/train.py", line 64, in train
    agent.train(encoder_optimizer, decoder_optimizer, interval, feedback=feedback_method)
  File "/disk2/yunhokim/Matterport3DSimulator/tasks/R2R/agent.py", line 307, in train
    self.rollout()
  File "/disk2/yunhokim/Matterport3DSimulator/tasks/R2R/agent.py", line 273, in rollout
    for i,ob in enumerate(perm_obs):
KeyboardInterrupt
